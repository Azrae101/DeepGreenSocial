<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social & Green - Sustainable Living Platform</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* Global Styles */
        :root {
            --primary-green: #2e7d32;
            --light-green: #4caf50;
            --dark-green: #1b5e20;
            --accent-color: #ff9800;
            --light-gray: #f5f5f5;
            --dark-gray: #424242;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo h1 {
            color: var(--primary-green);
            font-size: 24px;
            margin-left: 10px;
        }

        .logo-icon {
            font-size: 28px;
            color: var(--primary-green);
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--dark-gray);
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        nav ul li a:hover {
            background-color: var(--light-green);
            color: var(--white);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .btn-login {
            background-color: transparent;
            color: var(--primary-green);
            border: 1px solid var(--primary-green);
        }

        .btn-register {
            background-color: var(--primary-green);
            color: var(--white);
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(46, 125, 50, 0.8), rgba(46, 125, 50, 0.9)), url('https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2074&q=80');
            background-size: cover;
            background-position: center;
            color: var(--white);
            padding: 80px 0;
            text-align: center;
        }

        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .btn-hero {
            background-color: var(--accent-color);
            color: var(--white);
            padding: 12px 24px;
            font-size: 1.1rem;
        }

        /* Section Styles */
        section {
            padding: 60px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 40px;
            color: var(--primary-green);
        }

        .section-title h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .section-title p {
            color: var(--dark-gray);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .feature-card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
        }

        .feature-icon {
            font-size: 40px;
            color: var(--primary-green);
            margin-bottom: 20px;
        }

        .feature-card h3 {
            margin-bottom: 15px;
            color: var(--dark-green);
        }

        /* Events Section */
        .events-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .event-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .event-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
            position: relative;
        }

        .event-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
        }

        .event-image span {
            z-index: 1;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }

        .event-details {
            padding: 20px;
        }

        .event-date {
            display: inline-block;
            background-color: var(--light-green);
            color: var(--white);
            padding: 5px 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .event-card h3 {
            margin-bottom: 10px;
            color: var(--dark-green);
        }

        .event-card p {
            margin-bottom: 15px;
            color: var(--dark-gray);
        }

        .event-signup-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .event-participants {
            color: var(--dark-gray);
        }

        .event-points {
            color: var(--primary-green);
            font-weight: 500;
        }

        .btn-event {
            background-color: var(--primary-green);
            color: var(--white);
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .events-disclaimer {
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        /* News Section */
        .news-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .news-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .news-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            position: relative;
        }

        .news-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
        }

        .news-content {
            padding: 20px;
        }

        .news-date {
            color: var(--dark-gray);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .news-card h3 {
            margin-bottom: 10px;
            color: var(--dark-green);
        }

        .news-card p {
            margin-bottom: 15px;
            color: var(--dark-gray);
        }

        .btn-news {
            background-color: var(--primary-green);
            color: var(--white);
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        /* Points System Section */
        .points-system {
            background-color: var(--white);
            border-radius: 8px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-top: 40px;
        }

        .points-system h3 {
            color: var(--dark-green);
            margin-bottom: 20px;
            text-align: center;
        }

        .points-benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .benefit-item {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--light-gray);
        }

        .benefit-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--primary-green);
        }

        /* Statistics Section */
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-green);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--dark-gray);
        }

        /* Footer */
        footer {
            background-color: var(--dark-green);
            color: var(--white);
            padding: 40px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column ul li a {
            color: var(--light-gray);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-column ul li a:hover {
            color: var(--accent-color);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .social-icon {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: var(--light-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            text-decoration: none;
            transition: background-color 0.3s ease;
        }

        .social-icon:hover {
            background-color: var(--accent-color);
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                padding: 15px 0;
            }

            nav ul {
                margin: 15px 0;
            }

            .auth-buttons {
                margin-top: 10px;
            }

            .hero h2 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }
            
            .game-stats {
                flex-direction: column;
                gap: 20px;
            }
        }

        .btn-cancel {
            background-color: #dc3545 !important;
            color: white;
        }
        
        .btn-cancel:hover {
            background-color: #c82333 !important;
        }
        
        .event-address {
            margin-bottom: 15px;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }



    .events-container, #current-events-list, #old-events-list {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
    }

    @media (max-width: 1100px) {
        .events-container, #current-events-list, #old-events-list {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .events-container, #current-events-list, #old-events-list {
            grid-template-columns: 1fr;
        }
    }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <span class="logo-icon">üå±</span>
                <h1>Social & Green</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#events">Events</a></li>
                    <li><a href="#map">Secondhand Stores</a></li>
                    <li><a href="game.html">Games</a></li>
                </ul>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <!-- Buttons will be dynamically inserted here -->
            </div>

            <script>
                // Update auth buttons based on login status
                function updateAuthButtons() {
                    const authButtons = document.getElementById('authButtons');
                    const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
                    
                    if (currentUser) {
                        // User is logged in
                        authButtons.innerHTML = `
                            <span style="margin-right: 15px; color: var(--primary-green);">Welcome, ${currentUser.firstName}</span>
                            <a href="points.html" class="btn btn-login">My Points</a>
                            <button class="btn btn-register" id="logoutBtn">Logout</button>
                        `;
                        
                        document.getElementById('logoutBtn').addEventListener('click', function() {
                            localStorage.removeItem('sustainalearn_currentUser');
                            window.location.reload();
                        });
                    } else {
                        // User is not logged in
                        authButtons.innerHTML = `
                            <button class="btn btn-login" id="loginBtn">Login</button>
                            <button class="btn btn-register" id="registerBtn">Register</button>
                        `;
                        
                        document.getElementById('loginBtn').addEventListener('click', function() {
                            window.location.href = 'login.html';
                        });
                        
                        document.getElementById('registerBtn').addEventListener('click', function() {
                            window.location.href = 'register.html';
                        });
                    }
                }
                
                // Initialize auth buttons on page load
                document.addEventListener('DOMContentLoaded', updateAuthButtons);
            </script>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="container">
            <h2>Take Real Climate Action Together</h2>
            <p>Social & Green is a youth-driven platform for hands-on, sustainable events and rewarding initiatives. We help you make a difference through action, not just activism or personal sacrifice.</p>
        </div>
    </section>

    <!-- Features Section -->
    <section>
        <div class="container">
            <div class="section-title">
                <h2>Why Social & Green?</h2>
                <p>Most climate initiatives ask you to do less: eat less meat, fly less, or protest against polluters. We offer a solution where you take action and do something good for the climate, together.</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <h3>Hands-On Events</h3>
                    <p>Join group activities like trash cleanups, recycling drives, and repair workshops. Every event is designed to make a real, positive impact.</p>
                </div>
                <div class="feature-card">
                    <h3>Social Community</h3>
                    <p>Meet others who want to help the climate. Build friendships and work together for a better future.</p>
                </div>
            </div>
            <div class="features-grid" style="margin-top:32px;">
                <div class="feature-card">
                    <h3>Point System & Rewards</h3>
                    <p>Earn points for every action. Redeem them for eco-friendly rewards, experiences, or donations. Your effort is recognized and celebrated.</p>
                </div>
                <div class="feature-card">
                    <h3>Educational & Gamified Learning</h3>
                    <p>Access practical guides, workshops, and games that teach you how to help the climate in fun, effective ways.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Points System Section -->
    <section>
        <div class="container">
            <div class="section-title">
                <h2>Track Your Impact</h2>
                <p>Measure your contributions and see the difference you make through our transparent points system.</p>
            </div>
            <div class="points-system">
                <h3>How It Works</h3>
                <p>Earn points for every sustainable action, event participation, and advocacy effort. Your impact is recognized and celebrated‚Äîbecause every action counts.</p>
                <div class="points-benefits">
                    <div class="benefit-item">
                        <strong>Participate in Events</strong><br>
                        Join workshops, cleanups, and campaigns to earn points and drive change.
                    </div>
                    <div class="benefit-item">
                        <strong>Share Knowledge</strong><br>
                        Educate others and spread awareness to multiply your impact.
                    </div>
                    <div class="benefit-item">
                        <strong>Redeem Rewards</strong><br>
                        Use your points for eco-friendly products, experiences, or donations.
                    </div>
                </div>
                <p style="margin-top: 20px; font-style: italic; color: var(--dark-gray);">
                    Points are a reflection of your commitment to a sustainable future.
                </p>
            </div>
        </div>
    </section>
    
    <!-- Events Section -->
    <section id="events">
        <div class="container">
            <div class="section-title">
                <h2>Upcoming Events</h2>
                <p>Join our community events and make a difference. Participate in workshops, cleanups, and more.</p>
            </div>

            <!-- Current Events -->
            <div id="current-events-list" class="events-container"></div>
            <div id="no-current-events-message" style="display:none; margin: 32px 0; text-align:center; color: var(--dark-gray); font-size: 1.1rem;"></div>

            <!-- Old Events Toggle -->
            <div style="margin-top:40px;">
                <button id="toggle-old-events" class="btn btn-event" style="width:100%;max-width:340px;margin:0 auto;display:block;">Show Old Events</button>
                <div id="old-events-section" style="display:none; margin-top:24px;">
                    <div id="old-events-list" class="events-container"></div>
                    <button id="see-more-old-events" class="btn btn-event" style="width:100%;max-width:340px;margin:24px auto 0 auto;display:none;">See more</button>
                </div>
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section id="news">
        <div class="container">
            <div class="section-title">
                <h2>Environmental News</h2>
                <p>Stay informed with the latest updates, research, and stories from the frontlines of sustainability.</p>
            </div>
            <div class="news-container">
                <div class="news-card">
                    <div class="news-image">
                        <img src="plastic.jpg" alt="Plastic waste reduction tips" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>                    
                        <div class="news-content">
                        <div class="news-date">November 5, 2025</div>
                        <h3>5 Simple Ways to Reduce Plastic Waste</h3>
                        <p>Discover easy-to-implement strategies to minimize your plastic footprint and contribute to a cleaner planet.</p>
                        <a href="article1.html" class="btn btn-news">Read More</a>
                    </div>
                </div>
                <div class="news-card">
                    <div class="news-image" style="background-image: url('https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2074&q=80')"></div>
                    <div class="news-content">
                        <div class="news-date">October 28, 2025</div>
                        <h3>Local Community Reduces Carbon Footprint by 15%</h3>
                        <p>Learn how a neighborhood in Aarhus implemented community-wide sustainability initiatives with impressive results.</p>
                        <a href="article2.html" class="btn btn-news">Read More</a>
                    </div>
                </div>
                <div class="news-card">
                    <div class="news-image" style="background-image: url('https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80')"></div>
                    <div class="news-content">
                        <div class="news-date">October 20, 2025</div>
                        <h3>The Future of Sustainable Fashion</h3>
                        <p>Explore how innovative materials and circular economy models are transforming the fashion industry.</p>
                        <a href="article3.html" class="btn btn-news">Read More</a>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Social & Green</h3>
                    <p>Making sustainability accessible, engaging, and actionable for everyone.</p>
                    <div class="social-links">
                        <a href="#" class="social-icon">f</a>
                        <a href="#" class="social-icon">in</a>
                        <a href="#" class="social-icon">ig</a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#events">Events</a></li>
                        <li><a href="game.html">Games</a></li>
                        <li><a href="#news">News</a></li>
                        <li><a href="#statistics">Statistics</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul>
                        <li>123 Green Street, Eco City</li>
                        <li>+1 (123) 456-7890</li>
                        <li>info@greensocial.com</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Social & Green. All rights reserved. | Designed with ‚ôªÔ∏è for a greener planet</p>
            </div>
        </div>
    </footer>
<script>
<script>
    // Event data with proper date parsing
    const eventData = [
        {
            id: 1,
            name: 'Yoga for Jorden - Morgenyoga & Morgenmad',
            date: '6/12 - 10:00‚Äì11:30',
            image: 'images/yoga.jpg',
            title: 'Yoga for Jorden',
            description: 'Gratis yoga efterfulgt af morgenmad arrangeret af Den Gr√∏nne Ungdomsbev√¶gelse Aarhus. Alle kan v√¶re med - ingen erfaring n√∏dvendig. Et roligt f√¶llesskab med fokus p√• kropslig omsorg, n√¶rv√¶r og b√¶redygtighed. NB: F√∏rst-til-m√∏lle.',
            location: 'N. J. Fjords Gade 2, Aarhus C',
            points: '+10 pts signup | +200 pts completion',
            link: 'https://forms.gle/X7yoNK7Jb7xpUh6UA',
            linkText: 'Tilmelding 6/12'
        },
        {
            id: 2,
            name: 'Repair Caf√© Aarhus',
            date: '12/12 - 12:30‚Äì15:30',
            image: 'images/repaircafe.jpg',
            title: 'Repair Caf√©',
            description: 'Come by and repair your clothes, electronics, or bike with help from our team of volunteers! We\'re all about giving our belongings a second chance instead of throwing them away and buying new. It\'s free and we\'ve got the tools, but remember to bring your own spare parts. You can find us on the stairs at Dokk1 ‚Äì every month ‚ôªÔ∏èüõ†',
            location: 'Dokk1, 8000 Aarhus, Denmark',
            points: '+10 pts signup | +200 pts completion',
            link: 'https://www.dokk1.dk',
            linkText: 'Se flere datoer'
        },
        {
            id: 3,
            name: 'INDEND√òRS JuleMARKED - Vejlby-Risskov Hallen',
            date: '7/12 - 10:00‚Äì16:00',
            image: 'images/market.jpg',
            title: 'Julemarked',
            description: 'Kom til det store juleloppemarked med 82 stande fyldt med julepynt, antik, leget√∏j, t√∏j og brugskunst. Her finder du gran, kogler, nisser, kalenderlys, kravlenisser, kugler, gl√∏gg, √¶bleskiver og meget mere. G√∏r noget for klimaet - k√∏b genbrug! Forventer ca. 3.000 bes√∏gende.',
            location: 'Vejlby Centervej 51, 8240 Risskov',
            points: '+10 pts signup | +200 pts completion',
            link: 'mailto:kurt@kloborg.dk?subject=Tilmelding%20til%20Julemarked',
            linkText: 'Kontakt tilmelding'
        },
        {
            id: 4,
            name: 'R√•-hyggeligt Julemarked hos Hjerteland',
            date: '7/12 - 12:00‚Äì17:00',
            image: 'images/market2.jpg',
            title: 'Julemarked',
            description: 'Kom til et hyggeligt julemarked i smukke omgivelser med duften af gl√∏gg og √¶bleskiver. Find unikke julegaver som smykker, keramik, t√∏j, sko, naturlige cremer, malerier, dr√∏mmefangere, √∏jenpuder, h√•ndv√¶rk i tr√¶, honning, cookies, pebern√∏dder og meget mere.',
            location: 'Nym√∏llevej 8, 8200 Aarhus N',
            points: '+10 pts signup | +200 pts completion',
            link: 'mailto:hjerteogko@live.dk?subject=Stand%20til%20Julemarked',
            linkText: 'Book stand'
        },
        {
            id: 5,
            name: 'Ananda Organics - √òkologisk Hudpleje Lancering',
            date: '16/12 - 16:30‚Äì18:00',
            image: 'images/health.png',
            title: 'Produktlancering',
            description: 'Kom og fejr lanceringen af Ananda Organics - certificeret √∏kologisk hudpleje med 90-100% √∏kologiske ingredienser. F√• 30% rabat p√• luksuri√∏se ansigtsolier, fugtserum, mists, body butter, urtesalver og aromaterapi.',
            location: 'Hjerterum, Aarhus',
            points: '+10 pts signup | +200 pts completion',
            link: 'https://www.annaananda.dk/',
            linkText: 'Bes√∏g hjemmeside'
        },
        {
            id: 6,
            name: 'Community Gardening Workshop',
            date: '15/11 - 10:00‚Äì14:00',
            image: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            title: 'Gardening Workshop',
            description: 'Learn sustainable gardening techniques and help maintain our community garden.',
            location: 'Aarhus Community Garden, 8000 Aarhus C',
            points: '+10 pts signup | +200 pts completion',
            link: '#',
            linkText: 'Event Ended'
        },
        {
            id: 7,
            name: 'Sustainable Cooking Class',
            date: '22/11 - 17:00‚Äì20:00',
            image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            title: 'Cooking Class',
            description: 'Learn how to cook delicious meals using locally sourced, sustainable ingredients.',
            location: 'Green Kitchen Aarhus, 8200 Aarhus N',
            points: '+10 pts signup | +200 pts completion',
            link: '#',
            linkText: 'Event Ended'
        },
        {
            id: 8,
            name: 'Beach Cleanup & Awareness',
            date: '29/11 - 09:00‚Äì12:00',
            image: 'https://images.unsplash.com/photo-1581579438747-1dc8d17bbce4?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            title: 'Beach Cleanup',
            description: 'Join us for a beach cleanup to protect our local marine environment.',
            location: 'Aarhus Beach, 8000 Aarhus C',
            points: '+10 pts signup | +200 pts completion',
            link: '#',
            linkText: 'Event Ended'
        },
        {
            id: 9,
            name: 'Plastic Reduction Workshop',
            date: '5/11 - 13:00‚Äì16:00',
            image: 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?ixlib=rb-4.0.3&auto=format&fit=crop&w=2074&q=80',
            title: 'Plastic Workshop',
            description: 'Learn how to reduce plastic waste in your daily life with practical tips and alternatives.',
            location: 'Eco Center Aarhus, 8000 Aarhus C',
            points: '+10 pts signup | +200 pts completion',
            link: '#',
            linkText: 'Event Ended'
        }
    ];

    // Function to parse Danish date format (d/m)
    function parseDanishDate(dateStr) {
        // Extract date part (e.g., "6/12 - 10:00‚Äì11:30" -> "6/12")
        const datePart = dateStr.split(' - ')[0];
        const [day, month] = datePart.split('/').map(num => parseInt(num, 10));
        
        // Get current year
        const currentYear = new Date().getFullYear();
        
        // Create date object (months are 0-indexed in JavaScript)
        return new Date(currentYear, month - 1, day);
    }

    // Function to render event card
    function renderEventCard(event) {
        return `
        <div class="event-card">
            <div class="event-image" style="background-image: url('${event.image}')">
                <span>${event.title}</span>
            </div>
            <div class="event-details">
                <span class="event-date">${event.date}</span>
                <h3>${event.name}</h3>
                <p>${event.description}</p>
                <div class="event-signup-info">
                    <div class="event-participants">${event.location}</div>
                    <div class="event-points">${event.points}</div>
                </div>
                <a href="${event.link}" ${event.linkText.includes('Ended') ? '' : 'target="_blank"'} class="btn btn-event">${event.linkText}</a>
            </div>
        </div>
        `;
    }

    // Initialize events when page loads
    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date();
        today.setHours(0, 0, 0, 0); // Set to beginning of day for comparison
        
        let currentEvents = [];
        let oldEvents = [];
        
        // Sort events by date (ascending)
        eventData.sort((a, b) => {
            const dateA = parseDanishDate(a.date);
            const dateB = parseDanishDate(b.date);
            return dateA - dateB;
        });
        
        // Separate current and old events
        eventData.forEach(event => {
            const eventDate = parseDanishDate(event.date);
            
            // Check if event is today or in the future
            if (eventDate >= today) {
                currentEvents.push(event);
            } else {
                oldEvents.push(event);
            }
        });
        
        // Get DOM elements
        const currentEventsList = document.getElementById('current-events-list');
        const noCurrentMsg = document.getElementById('no-current-events-message');
        const toggleBtn = document.getElementById('toggle-old-events');
        const oldSection = document.getElementById('old-events-section');
        const oldList = document.getElementById('old-events-list');
        const seeMoreBtn = document.getElementById('see-more-old-events');
        
        let oldEventsShown = 5;
        
        // Function to render old events
        function renderOldEvents() {
            const eventsToShow = oldEvents.slice(0, oldEventsShown);
            oldList.innerHTML = eventsToShow.map(renderEventCard).join('');
            
            // Show/hide "See more" button
            if (oldEvents.length > oldEventsShown) {
                seeMoreBtn.style.display = 'block';
            } else {
                seeMoreBtn.style.display = 'none';
            }
        }
        
        // Handle current events
        if (currentEvents.length === 0) {
            noCurrentMsg.style.display = 'block';
            noCurrentMsg.textContent = 'No current events: the events will be updated once a week. Come back to check again soon.';
        } else {
            currentEventsList.innerHTML = currentEvents.map(renderEventCard).join('');
        }
        
        // Handle old events toggle
        toggleBtn.addEventListener('click', function() {
            if (oldSection.style.display === 'none') {
                oldSection.style.display = 'block';
                toggleBtn.textContent = 'Hide Old Events';
                renderOldEvents();
            } else {
                oldSection.style.display = 'none';
                toggleBtn.textContent = 'Show Old Events';
            }
        });
        
        // Handle "See more" button
        seeMoreBtn.addEventListener('click', function() {
            oldEventsShown += 5;
            renderOldEvents();
        });
        
        // Hide "Show Old Events" button if there are no old events
        if (oldEvents.length === 0) {
            toggleBtn.style.display = 'none';
        }
    });
</script>

<script></script>
        {
            id: 3,
            name: "Trunk Market at Bispetorv",
            type: "flea-market",
            address: "Teatergaden 1, 8000 Aarhus C",
            description: "A trunk market located near the cathedral in the center of Aarhus, perfect for finding hidden treasures.",
            hours: "Selected weekends, 10:30 AM - 3:30 PM",
            price: "Free",
            lat: 56.1587,
            lng: 10.2107
        },
        {
            id: 4,
            name: "Loppehuset in H√∏jbjerg",
            type: "flea-market",
            address: "S√∏ren Nymarks Vej 6L, 8270 H√∏jbjerg",
            description: "A hidden gem offering a wealth of used furniture, clothing, books, retro finds and much more.",
            hours: "Selected weekends, 11:00 AM - 2:00 PM",
            price: "Free",
            lat: 56.1155,
            lng: 10.1837
        },
        // Red Cross stores
        {
            id: 5,
            name: "R√∏de Kors Aarhus",
            type: "red-cross",
            address: "Muslingevej 24, 8250 Eg√•",
            description: "Red Cross secondhand store offering quality used items at affordable prices.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1934,
            lng: 10.1362
        },
        {
            id: 6,
            name: "R√∏de Kors H√∏jbjerg",
            type: "red-cross",
            address: "Oddervej 58A, 8270 H√∏jbjerg",
            description: "Red Cross secondhand store in H√∏jbjerg area.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1178,
            lng: 10.1765
        },
        {
            id: 7,
            name: "R√∏de Kors Holme",
            type: "red-cross",
            address: "Holme Byvej 38, 8270 H√∏jbjerg",
            description: "Red Cross secondhand store in Holme area.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1102,
            lng: 10.1893
        },
        // Blue Cross and other stores
        {
            id: 8,
            name: "Blue Cross Op Shop",
            type: "secondhand",
            address: "Paludan-M√ºllers Vej 38, 8200 Aarhus N",
            description: "Blue Cross secondhand store with a good selection of clothing and household items.",
            hours: "Mon-Fri: 10:00 AM - 5:30 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1712,
            lng: 10.1754
        },
        {
            id: 9,
            name: "Vintage Divine",
            type: "secondhand",
            address: "Klostergade 58, 8000 Aarhus C",
            description: "Highly rated vintage store with curated selection of clothing and accessories.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1589,
            lng: 10.2087
        },
        {
            id: 10,
            name: "Brugtvare Terminalen",
            type: "secondhand",
            address: "√òlleg√•rdsvej 3, 8000 Aarhus C",
            description: "Large secondhand store with furniture, clothing, and various household items.",
            hours: "Mon-Fri: 10:00 AM - 6:00 PM, Sat: 10:00 AM - 3:00 PM",
            price: "Various",
            lat: 56.1623,
            lng: 10.2015
        },
        {
            id: 11,
            name: "Kirkens Korsh√¶r N√∏rre All√©",
            type: "secondhand",
            address: "N√∏rre Alle 25, 8000 Aarhus C",
            description: "Army Salvation secondhand store in the city center.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1602,
            lng: 10.2034
        },
        {
            id: 12,
            name: "Folkekirkens N√∏dhj√¶lp",
            type: "secondhand",
            address: "Silkeborgvej 285, 8000 Aarhus C",
            description: "DanChurchAid secondhand store supporting humanitarian work.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1689,
            lng: 10.1623
        },
        {
            id: 13,
            name: "Resecond",
            type: "secondhand",
            address: "J√¶gerg√•rdsgade 51, 8000 Aarhus C",
            description: "Secondhand fashion store focusing on quality and style.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1479,
            lng: 10.2073
        },
        {
            id: 14,
            name: "Kirkens Korsh√¶r Aarhus N",
            type: "secondhand",
            address: "Paludan-M√ºllers Vej 26, 8200 Aarhus N",
            description: "Army Salvation secondhand store in Aarhus N.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1710,
            lng: 10.1758
        },
        {
            id: 15,
            name: "Bl√• Kors",
            type: "secondhand",
            address: "Paludan-M√ºllers Vej 38, 8200 Aarhus N",
            description: "Blue Cross secondhand store.",
            hours: "Mon-Fri: 10:00 AM - 5:30 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1712,
            lng: 10.1754
        },
        {
            id: 16,
            name: "Kirkens Korsh√¶r Mejlgade",
            type: "secondhand",
            address: "Mejlgade 19, 8000 Aarhus C",
            description: "Army Salvation secondhand store in the Latin Quarter.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1592,
            lng: 10.2098
        },
        {
            id: 17,
            name: "Igen Genbrugsbutik",
            type: "secondhand",
            address: "√Öbogade 36A, 8200 Aarhus N",
            description: "Secondhand store with focus on sustainability and recycling.",
            hours: "Mon-Fri: 10:00 AM - 6:00 PM, Sat: 10:00 AM - 3:00 PM",
            price: "Various",
            lat: 56.1698,
            lng: 10.1789
        },
        {
            id: 18,
            name: "Lille Nor",
            type: "secondhand",
            address: "Frederiks All√© 116, 8000 Aarhus C",
            description: "Small secondhand store with curated selection.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1512,
            lng: 10.1923
        },
        {
            id: 19,
            name: "Reshop Vintage",
            type: "secondhand",
            address: "Hasleg√•rdsvej 8, 8210 Aarhus V",
            description: "Vintage clothing store in Hasle area.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1402,
            lng: 10.1498
        },
        {
            id: 20,
            name: "Folkekirkens N√∏dhj√¶lp Vesterbro",
            type: "secondhand",
            address: "Vesterbro Torv 1A, 8000 Aarhus C",
            description: "DanChurchAid secondhand store at Vesterbro Torv.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1567,
            lng: 10.1923
        },
        {
            id: 21,
            name: "And Vintage",
            type: "secondhand",
            address: "Studsgade 40, 8000 Aarhus C",
            description: "Vintage store with unique finds and retro items.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1598,
            lng: 10.2112
        },
        {
            id: 22,
            name: "R√∏de Kors √Öbyh√∏j",
            type: "red-cross",
            address: "Silkeborgvej 236, 8230 √Öbyh√∏j",
            description: "Red Cross secondhand store in √Öbyh√∏j area.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1389,
            lng: 10.1567
        },
        {
            id: 23,
            name: "Folkekirkens N√∏dhj√¶lp Randersvej",
            type: "secondhand",
            address: "Randersvej 73, 8200 Aarhus N",
            description: "DanChurchAid secondhand store on Randersvej.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1801,
            lng: 10.1892
        },
        {
            id: 24,
            name: "Trojborg Retro & Lopper",
            type: "secondhand",
            address: "Tordenskjoldsgade 63, 8200 Aarhus N",
            description: "Retro and flea market style store in Tr√∏jborg.",
            hours: "Mon-Fri: 11:00 AM - 6:00 PM, Sat: 10:00 AM - 4:00 PM",
            price: "Various",
            lat: 56.1667,
            lng: 10.2015
        },
        {
            id: 25,
            name: "√Örhus Kr√¶mmermarked",
            type: "flea-market",
            address: "Strandparken 27, 8000 Aarhus C",
            description: "Traditional flea market in Aarhus.",
            hours: "Selected weekends, check locally",
            price: "Free entry",
            lat: 56.1502,
            lng: 10.2101
        },
        {
            id: 26,
            name: "R√∏de Kors Brabrand",
            type: "red-cross",
            address: "Edwin Rahrs Vej 32P, 8220 Brabrand",
            description: "Red Cross secondhand store in Brabrand.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1589,
            lng: 10.1298
        },
        {
            id: 27,
            name: "Kirkens Korsh√¶r Vestergade",
            type: "secondhand",
            address: "Vestergade 37, 8000 Aarhus C",
            description: "Army Salvation secondhand store on Vestergade.",
            hours: "Mon-Fri: 10:00 AM - 5:00 PM, Sat: 10:00 AM - 2:00 PM",
            price: "Various",
            lat: 56.1562,
            lng: 10.2034
        },
        // Recycling centers
        {
            id: 28,
            name: "Aarhus Recycling Center",
            type: "recycling",
            address: "Lystrupvej 62, 8200 Aarhus N",
            description: "A facility where you can drop off various types of waste for recycling, including electronics, hazardous waste, and more.",
            hours: "Mon-Fri: 8:00 AM - 6:00 PM, Sat-Sun: 9:00 AM - 4:00 PM",
            price: "Free for most items",
            lat: 56.1896,
            lng: 10.1689
        },
        {
            id: 29,
            name: "Red Cross Recycling Container",
            type: "recycling",
            address: "Bildbjergvej 2, 8200 Aarhus N",
            description: "Red Cross recycling container for clothing and textiles.",
            hours: "24/7",
            price: "Free",
            lat: 56.1734,
            lng: 10.1821
        },
        {
            id: 30,
            name: "Red Cross Genbrugscontainer",
            type: "recycling",
            address: "Fj√¶ldev√¶nget 114, 8210 Aarhus V",
            description: "Red Cross recycling container for clothing and textiles.",
            hours: "24/7",
            price: "Free",
            lat: 56.1423,
            lng: 10.1389
        }
    ];

    // Initialize the map
    function initMap() {
        // Create map centered on Aarhus
        map = L.map('map').setView([56.1629, 10.2039], 12);
        
        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Define marker colors based on type
        const typeColors = {
            'flea-market': '#4CAF50',
            'secondhand': '#2196F3',
            'community': '#FF9800',
            'red-cross': '#f44336',
            'recycling': '#9C27B0'
        };
        
        // Create custom icons
        function createCustomIcon(type) {
            return L.divIcon({
                className: 'custom-marker',
                html: '<div style="background-color: ' + typeColors[type] + '; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2);"></div>',
                iconSize: [20, 20],
                iconAnchor: [10, 10]
            });
        }
        
        // Add markers for each location and store references
        sustainableLocations.forEach(location => {
            const marker = L.marker([location.lat, location.lng], {
                icon: createCustomIcon(location.type)
            }).addTo(map);
            
            // Store marker reference by ID
            markers[location.id] = marker;
            
            // Create popup content
            const popupContent =
                '<div style="max-width: 250px;">' +
                '<h3 style="margin: 0 0 10px; color: ' + typeColors[location.type] + ';">' + location.name + '</h3>' +
                '<p><strong>Address:</strong> ' + location.address + '</p>' +
                '<p><strong>Hours:</strong> ' + location.hours + '</p>' +
                '<p><strong>Price:</strong> ' + location.price + '</p>' +
                '<p>' + location.description + '</p>' +
                '</div>';
            marker.bindPopup(popupContent);
        });
    }

    // Initialize location cards
    function initLocationCards() {
        const locationsList = document.getElementById('locationsList');
        
        sustainableLocations.forEach(location => {
            const card = document.createElement('div');
            card.className = 'location-card';
            
            // Determine type class and display text
            let typeClass = '';
            let typeText = '';
            
            switch(location.type) {
                case 'flea-market':
                    typeClass = 'type-flea-market';
                    typeText = 'Flea Market';
                    break;
                case 'secondhand':
                    typeClass = 'type-secondhand';
                    typeText = 'Secondhand Store';
                    break;
                case 'recycling':
                    typeClass = 'type-recycling';
                    typeText = 'Recycling Center';
                    break;
                case 'community':
                    typeClass = 'type-community';
                    typeText = 'Community Garden';
                    break;
                case 'red-cross':
                    typeClass = 'type-red-cross';
                    typeText = 'Red Cross Store';
                    break;
            }
            
            card.innerHTML =
                '<div class="location-header">' +
                    '<h3 class="location-name">' + location.name + '</h3>' +
                    '<span class="location-type ' + typeClass + '">' + typeText + '</span>' +
                '</div>' +
                '<div class="location-details">' +
                    '<div class="location-detail">' +
                        '<span class="detail-icon">üìç</span>' +
                        '<span>' + location.address + '</span>' +
                    '</div>' +
                    '<div class="location-detail">' +
                        '<span class="detail-icon">üïí</span>' +
                        '<span>' + location.hours + '</span>' +
                    '</div>' +
                    '<div class="location-detail">' +
                        '<span class="detail-icon">üí∞</span>' +
                        '<span>' + location.price + '</span>' +
                    '</div>' +
                '</div>' +
                '<p>' + location.description + '</p>' +
                '<button class="btn btn-location" onclick="showOnMap(' + location.id + ')">Show on Map</button>';
            
            locationsList.appendChild(card);
        });
    }
    
    // Function to show location on map
    function showOnMap(locationId) {
        const location = sustainableLocations.find(loc => loc.id === locationId);
        const marker = markers[locationId];
        
        if (location && marker) {
            // Center map on the location and zoom in
            map.setView([location.lat, location.lng], 16);
            // Open the popup for that location
            marker.openPopup();
        }
    }

    // Initialize everything when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize random participant counts for events
        document.getElementById('gardening-participants').textContent = 
            Math.floor(Math.random() * 10) + 1 + " people signed up";
        document.getElementById('cooking-participants').textContent = 
            Math.floor(Math.random() * 10) + 1 + " people signed up";
        document.getElementById('beach-cleanup-participants').textContent = 
            Math.floor(Math.random() * 10) + 1 + " people signed up";

        // Event sign-up functionality
        const eventButtons = document.querySelectorAll('.event-signup-btn');
        
        // Function to update button states
        function updateEventButtons() {
            const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
            
            eventButtons.forEach(button => {
                const eventName = button.getAttribute('data-event');
                
                if (!currentUser) {
                    // User is not logged in
                    button.textContent = 'Login to Sign Up - Free';
                    button.style.backgroundColor = '#6c757d'; // Gray color
                } else {
                    // User is logged in - check if already signed up
                    const users = JSON.parse(localStorage.getItem('sustainalearn_users')) || [];
                    const user = users.find(u => u.username === currentUser.username);
                    
                    if (user && user.events && user.events.includes(eventName)) {
                        // Already signed up
                        button.textContent = 'Signed Up';
                        button.disabled = true;
                        button.style.backgroundColor = '#6c757d'; // Gray color
                    } else {
                        // Not signed up yet
                        button.textContent = 'Sign Up - Free';
                        button.disabled = false;
                        button.style.backgroundColor = ''; // Reset to original color
                    }
                }
            });
        }
        
        // Add click event listeners
        eventButtons.forEach(button => {
            button.addEventListener('click', function() {
                const eventName = this.getAttribute('data-event');
                const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
                
                if (!currentUser) {
                    // Redirect to login if not logged in
                    alert('Please log in to sign up for events');
                    window.location.href = 'login.html';
                    return;
                }
                
                // Get user data
                const users = JSON.parse(localStorage.getItem('sustainalearn_users')) || [];
                const userIndex = users.findIndex(u => u.username === currentUser.username);
                
                if (userIndex === -1) {
                    alert('User not found. Please log in again.');
                    return;
                }
                
                // Initialize events array if it doesn't exist
                if (!users[userIndex].events) {
                    users[userIndex].events = [];
                }
                
                // Check if user is already signed up
                if (users[userIndex].events.includes(eventName)) {
                    alert('You are already signed up for this event!');
                    return;
                }
                
                // Add event to user's events
                users[userIndex].events.push(eventName);
                
                // Add points for signing up (10 points per event)
                if (!users[userIndex].points) {
                    users[userIndex].points = 0;
                }
                users[userIndex].points += 10;
                
                // Update localStorage
                localStorage.setItem('sustainalearn_users', JSON.stringify(users));
                localStorage.setItem('sustainalearn_currentUser', JSON.stringify(users[userIndex]));
                
                // Update button
                this.textContent = 'Signed Up';
                this.disabled = true;
                this.style.backgroundColor = '#6c757d';
                
                // Update participant count
                const participantElement = document.getElementById(eventName + '-participants');
                const currentCount = parseInt(participantElement.textContent);
                participantElement.textContent = (currentCount + 1) + " people signed up";
                
                alert(`Successfully signed up for the event! You earned 10 points.`);
            });
        });
        
        // Initialize button states
        updateEventButtons();
        
        // Update buttons when auth status changes
        window.updateEventButtons = updateEventButtons;
        
        // Initialize map and location cards
        initMap();
        initLocationCards();
        updateAuthButtons();
    });
</script>
<script>
    // Event data with addresses and times
    const eventData = {
        "gardening": {
            name: "Community Gardening Workshop",
            date: "June 15, 2023",
            time: "10:00 AM - 2:00 PM",
            address: "Aarhus Community Garden, 8000 Aarhus C",
            image: "https://images.unsplash.com/photo-1416879595882-3373a0480b5b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
            participants: Math.floor(Math.random() * 10) + 1
        },
        "cooking": {
            name: "Sustainable Cooking Class", 
            date: "June 22, 2023",
            time: "5:00 PM - 8:00 PM",
            address: "Green Kitchen Aarhus, 8200 Aarhus N",
            image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
            participants: Math.floor(Math.random() * 10) + 1
        },
        "beach-cleanup": {
            name: "Beach Cleanup & Awareness",
            date: "June 29, 2023",
            time: "9:00 AM - 12:00 PM",
            address: "Aarhus Beach, 8000 Aarhus C",
            image: "https://images.unsplash.com/photo-1581579438747-1dc8d17bbce4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
            participants: Math.floor(Math.random() * 10) + 1
        }
    };

    // Initialize event functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize event cards with addresses and participant counts
        Object.keys(eventData).forEach(eventId => {
            const event = eventData[eventId];
            const eventCard = document.querySelector(`.event-signup-btn[data-event="${eventId}"]`);
            
            if (eventCard) {
                const eventCardContainer = eventCard.closest('.event-card');
                
                // Add address and time to event details if not already present
                if (!eventCardContainer.querySelector('.event-address')) {
                    const eventDetails = eventCardContainer.querySelector('.event-details');
                    const addressElement = document.createElement('div');
                    addressElement.className = 'event-address';
                    addressElement.innerHTML = `
                        <div style="margin-bottom: 10px;">
                            <strong>Time:</strong> ${event.time}
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>Location:</strong> ${event.address}
                        </div>
                    `;
                    eventDetails.insertBefore(addressElement, eventDetails.querySelector('.event-signup-info'));
                }
                
                // Create cancel button container after signup info
                const signupInfo = eventCardContainer.querySelector('.event-signup-info');
                if (signupInfo && !eventCardContainer.querySelector('.event-cancel-btn')) {
                    const cancelButton = document.createElement('button');
                    cancelButton.className = 'btn btn-cancel event-cancel-btn';
                    cancelButton.setAttribute('data-event', eventId);
                    cancelButton.textContent = 'Cancel';
                    cancelButton.style.display = 'none';
                    cancelButton.style.marginTop = '5px';
                    cancelButton.style.padding = '6px 12px';
                    cancelButton.style.fontSize = '0.8rem';
                    
                    signupInfo.parentNode.insertBefore(cancelButton, signupInfo.nextSibling);
                }
                
                // Set participant count
                const participantElement = document.getElementById(`${eventId}-participants`);
                if (participantElement) {
                    participantElement.textContent = event.participants + " people signed up";
                }
            }
        });

        // Event sign-up functionality with separate cancel button
        const eventButtons = document.querySelectorAll('.event-signup-btn');
        
        // Function to update button states
        function updateEventButtons() {
            const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
            
            eventButtons.forEach(button => {
                const eventName = button.getAttribute('data-event');
                const cancelButton = document.querySelector(`.event-cancel-btn[data-event="${eventName}"]`);
                
                if (!currentUser) {
                    // User is not logged in
                    button.textContent = 'Login to Sign Up - Free';
                    button.style.backgroundColor = '#6c757d';
                    button.disabled = false;
                    if (cancelButton) cancelButton.style.display = 'none';
                } else {
                    // User is logged in - check if already signed up
                    const users = JSON.parse(localStorage.getItem('sustainalearn_users')) || [];
                    const user = users.find(u => u.username === currentUser.username);
                    
                    if (user && user.events && user.events.includes(eventName)) {
                        // Already signed up - show "Signed Up" and show cancel button
                        button.textContent = 'Signed Up';
                        button.disabled = true;
                        button.style.backgroundColor = '#6c757d';
                        if (cancelButton) cancelButton.style.display = 'inline-block';
                    } else {
                        // Not signed up yet
                        button.textContent = 'Sign Up - Free';
                        button.disabled = false;
                        button.style.backgroundColor = '';
                        if (cancelButton) cancelButton.style.display = 'none';
                    }
                }
            });
        }
        
        // Add click event listeners for sign up
        eventButtons.forEach(button => {
            button.addEventListener('click', function() {
                const eventName = this.getAttribute('data-event');
                const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
                
                if (!currentUser) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const users = JSON.parse(localStorage.getItem('sustainalearn_users')) || [];
                const userIndex = users.findIndex(u => u.username === currentUser.username);
                
                if (userIndex === -1) {
                    return;
                }
                
                if (!users[userIndex].events) {
                    users[userIndex].events = [];
                }
                
                // Check if already signed up to prevent duplicates
                if (users[userIndex].events.includes(eventName)) {
                    return;
                }
                
                // Sign up for event
                users[userIndex].events.push(eventName);
                
                // Add 10 points for signing up
                if (!users[userIndex].points) {
                    users[userIndex].points = 0;
                }
                users[userIndex].points += 10;
                
                localStorage.setItem('sustainalearn_users', JSON.stringify(users));
                localStorage.setItem('sustainalearn_currentUser', JSON.stringify(users[userIndex]));
                
                const participantElement = document.getElementById(eventName + '-participants');
                if (participantElement) {
                    const currentCount = parseInt(participantElement.textContent) || 0;
                    participantElement.textContent = (currentCount + 1) + " people signed up";
                }
                
                updateEventButtons();
            });
        });
        
        // Add click event listeners for cancellation
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('event-cancel-btn')) {
                const eventName = e.target.getAttribute('data-event');
                const currentUser = JSON.parse(localStorage.getItem('sustainalearn_currentUser'));
                
                if (!currentUser) {
                    return;
                }
                
                const users = JSON.parse(localStorage.getItem('sustainalearn_users')) || [];
                const userIndex = users.findIndex(u => u.username === currentUser.username);
                
                if (userIndex === -1) {
                    return;
                }
                
                if (!users[userIndex].events) {
                    users[userIndex].events = [];
                    return;
                }
                
                // Remove the event from user's events
                const eventIndex = users[userIndex].events.indexOf(eventName);
                if (eventIndex > -1) {
                    users[userIndex].events.splice(eventIndex, 1);
                    
                    // Remove 10 points (the sign-up points)
                    if (users[userIndex].points && users[userIndex].points >= 10) {
                        users[userIndex].points -= 10;
                    }
                    
                    localStorage.setItem('sustainalearn_users', JSON.stringify(users));
                    localStorage.setItem('sustainalearn_currentUser', JSON.stringify(users[userIndex]));
                    
                    const participantElement = document.getElementById(eventName + '-participants');
                    if (participantElement) {
                        const currentCount = parseInt(participantElement.textContent) || 0;
                        participantElement.textContent = Math.max(0, currentCount - 1) + " people signed up";
                    }
                    
                    updateEventButtons();
                }
            }
        });
        
        // Initialize button states
        updateEventButtons();
        window.updateEventButtons = updateEventButtons;
    });
        // Load sustainability events from JSON
    async function loadSustainabilityEvents() {
        try {
            const response = await fetch('aarhus_sustainability_events.json');
            const data = await response.json();
            
            // Update metadata
            document.getElementById('last-updated').textContent = 
                new Date(data.metadata.last_updated).toLocaleDateString('da-DK');
            document.getElementById('event-count').textContent = data.metadata.total_events;
            
            displayEvents(data.events);
        } catch (error) {
            console.error('Error loading events:', error);
            document.getElementById('events-container').innerHTML = `
                <div style="text-align: center; padding: 40px; background: white; border-radius: 8px;">
                    <h3>Could not load events</h3>
                    <p>Please try again later or check the JSON file.</p>
                    <p>Error: ${error.message}</p>
                </div>
            `;
        }
    }
    
    function displayEvents(events) {
        const container = document.getElementById('events-container');
        
        let html = '';
        
        events.forEach((event, index) => {
            // Get category icon
            const categoryIcons = {
                'cleaning': 'üóëÔ∏è',
                'food': 'üçΩÔ∏è',
                'repair': 'üîß',
                'workshop': 'üë®‚Äçüè´',
                'gardening': 'üåø',
                'transport': 'üö≤',
                'energy': '‚ö°',
                'community': 'üë•',
                'sustainability': 'üå±'
            };
            
            const mainCategory = event.categories && event.categories.length > 0 ? event.categories[0] : 'sustainability';
            const icon = categoryIcons[mainCategory] || 'üìÖ';
            
            // Truncate description if too long
            const description = event.description.length > 150 ? 
                event.description.substring(0, 150) + '...' : event.description;
            
            html += `
            <div class="event-card" data-event-id="${index}">
                <div class="event-image" style="background-image: url('${event.image || getDefaultImage(mainCategory)}'); background-color: ${getCategoryColor(mainCategory)}">
                    <span>${icon} ${mainCategory.toUpperCase()}</span>
                </div>
                <div class="event-details">
                    <span class="event-date">${event.date || 'Dato varierer'}</span>
                    ${event.time ? `<span style="margin-left: 10px; color: var(--dark-gray);">${event.time}</span>` : ''}
                    <h3>${event.title}</h3>
                    <div class="event-address">
                        ${event.location ? `<div style="margin-bottom: 10px;"><strong>üìç</strong> ${event.location}</div>` : ''}
                        ${event.address ? `<div style="margin-bottom: 15px; font-size: 0.9em;">${event.address}</div>` : ''}
                    </div>
                    <p>${description}</p>
                    <div class="event-signup-info">
                        <div class="event-participants">${event.source || 'Local event'}</div>
                        ${event.points ? `<div class="event-points">+${event.points} points</div>` : ''}
                    </div>
                    ${event.organizer ? `<div style="margin-top: 10px; font-size: 0.9rem; color: var(--dark-gray);"><strong>Organizer:</strong> ${event.organizer}</div>` : ''}
                    <a href="${event.link}" target="_blank" class="btn btn-event">View Event & Details</a>
                </div>
            </div>`;
        });
        
        container.innerHTML = html;
    }
    
    function getDefaultImage(category) {
        const categoryImages = {
            'cleaning': 'https://images.unsplash.com/photo-1581579438747-1dc8d17bbce4?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            'food': 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            'repair': 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2058&q=80',
            'workshop': 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?ixlib=rb-4.0.3&auto=format&fit=crop&w=2074&q=80',
            'gardening': 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            'transport': 'https://images.unsplash.com/photo-1571068316344-75bc76f77890?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
            'default': 'https://images.unsplash.com/photo-1466611653911-95081537e5b7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80'
        };
        
        return categoryImages[category] || categoryImages.default;
    }
    
    function getCategoryColor(category) {
        const colors = {
            'cleaning': '#4CAF50',
            'food': '#FF9800',
            'repair': '#2196F3',
            'workshop': '#9C27B0',
            'gardening': '#8BC34A',
            'transport': '#3F51B5',
            'energy': '#FFC107',
            'community': '#E91E63',
            'sustainability': '#009688'
        };
        
        return colors[category] || '#607D8B';
    }
    
    // Load events when page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadSustainabilityEvents();
    });
</script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
</html>