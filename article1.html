<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 Simple Ways to Reduce Plastic Waste - SustainaLearn</title>
    <link rel="icon" type="image/jpeg" href="images/logodgi.jpg">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <style>
        :root {
            --primary-green: #2e7d32;
            --light-green: #4caf50;
            --dark-green: #1b5e20;
            --accent-color: #ff9800;
            --light-gray: #f5f5f5;
            --dark-gray: #424242;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo a {
            display: flex;
            align-items: center;
            text-decoration: none;
            cursor: pointer;
        }

        .logo h1 {
            color: var(--primary-green);
            font-size: 24px;
            margin-left: 10px;
        }

        .logo-icon {
            font-size: 28px;
            color: var(--primary-green);
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
            position: relative;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--dark-gray);
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
            display: block;
        }

        nav ul li a:hover {
            background-color: var(--light-green);
            color: var(--white);
        }

        /* Dropdown Menu Styles */
        .dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: var(--white);
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            z-index: 1000;
            margin-top: 5px;
        }

        .dropdown-content a {
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            color: var(--dark-gray);
            transition: all 0.3s ease;
        }

        .dropdown-content a:hover {
            background-color: var(--light-gray);
            color: var(--primary-green);
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown > a::after {
            content: ' â–¼';
            font-size: 0.7em;
            margin-left: 5px;
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .btn-login {
            background-color: transparent;
            color: var(--primary-green);
            border: 1px solid var(--primary-green);
        }

        .btn-register {
            background-color: var(--primary-green);
            color: var(--white);
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* Article Styles */
        .article-section {
            padding: 40px 0;
        }

        .article-container {
            background-color: var(--white);
            border-radius: 8px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }

        .article-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .article-date {
            color: var(--dark-gray);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .article-title {
            font-size: 2rem;
            color: var(--dark-green);
            margin-bottom: 15px;
        }

        .article-image {
            width: 100%;
            height: 300px;
            background-color: var(--light-green);
            border-radius: 8px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
        }

        .article-content {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 40px;
        }

        .article-content h3 {
            color: var(--primary-green);
            margin: 25px 0 15px;
        }

        .article-content p {
            margin-bottom: 15px;
        }

        .article-content ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .article-content li {
            margin-bottom: 10px;
        }

        .action-buttons {
            text-align: center;
            margin: 30px 0;
            position: relative;
        }

        .points-feedback {
            display: inline-block;
            margin-left: 15px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.5s ease;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }

        .points-feedback.show {
            opacity: 1;
            transform: translateY(0);
        }

        .points-feedback::before {
            content: 'âœ“ ';
            font-size: 1.2rem;
        }

        .btn-read {
            background-color: var(--primary-green);
            color: var(--white);
            padding: 12px 24px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .btn-read:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .btn-quiz {
            background-color: var(--accent-color);
            color: var(--white);
            padding: 12px 24px;
            font-size: 1.1rem;
            margin-left: 15px;
        }

        .quiz-container {
            background-color: var(--light-gray);
            border-radius: 8px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }

        .quiz-title {
            color: var(--dark-green);
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-question {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 15px;
            color: var(--dark-gray);
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 10px;
            background-color: var(--white);
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .option:hover {
            background-color: #e8f5e9;
        }

        .option input {
            margin-right: 10px;
        }

        .quiz-result {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }

        .quiz-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .quiz-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .points-earned {
            font-weight: bold;
            color: var(--primary-green);
        }

        /* Footer */
        footer {
            background-color: var(--dark-green);
            color: var(--white);
            padding: 40px 0 20px;
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column ul li a {
            color: var(--light-gray);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-column ul li a:hover {
            color: var(--accent-color);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .social-icon {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: var(--light-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            text-decoration: none;
            transition: background-color 0.3s ease;
        }

        .social-icon:hover {
            background-color: var(--accent-color);
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                padding: 15px 0;
            }

            nav ul {
                margin: 15px 0;
            }

            .auth-buttons {
                margin-top: 10px;
            }

            .article-container {
                padding: 20px;
            }

            .article-title {
                font-size: 1.5rem;
            }

            .action-buttons {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }

            .btn-quiz {
                margin-left: 0;
            }
        }

        /* Toast Notification Styles */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #323232;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            max-width: 350px;
            word-wrap: break-word;
        }
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        .toast.success {
            background: #2e7d32;
        }
        .toast.error {
            background: #d32f2f;
        }
        .toast.info {
            background: #1976d2;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <a href="index.html">
                    <img src="images/logodgi.jpg" alt="Social & Green Logo" style="height: 40px; width: auto;">
                    <h1>Social & Green</h1>
                </a>
            </div>
            <nav>
                <ul>
                    <li class="dropdown">
                        <a href="index.html">Home</a>
                        <div class="dropdown-content">
                            <a href="index.html#events">Events</a>
                            <a href="index.html#news">News</a>
                            <a href="index.html#map">Sustainable Aarhus</a>
                        </div>
                    </li>
                    <li><a href="game-overview.html">Games</a></li>
                    <li><a href="community.html">Community</a></li>
                </ul>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <!-- Buttons will be dynamically inserted here -->
            </div>
        </div>
    </header>

    <!-- Article Section -->
    <section class="article-section">
        <div class="container">
            <div class="article-container">
                <div class="article-header">
                    <div class="article-date">June 5, 2023</div>
                    <h1 class="article-title">5 Simple Ways to Reduce Plastic Waste</h1>
                </div>

                <div class="article-image">
                    Plastic Waste Reduction
                </div>

                <div class="article-content">
                    <p>Plastic pollution has become one of the most pressing environmental issues of our time. With millions of tons of plastic entering our oceans each year, it's crucial that we all take steps to reduce our plastic footprint.</p>
                    
                    <h3>1. Use Reusable Bags and Containers</h3>
                    <p>One of the easiest ways to cut down on plastic waste is to bring your own reusable bags when shopping. Keep a few reusable bags in your car or by your door so you don't forget them. Similarly, use reusable containers for food storage instead of plastic wrap or single-use containers.</p>
                    
                    <h3>2. Choose Products with Minimal Packaging</h3>
                    <p>When shopping, look for products with minimal or no plastic packaging. Buy in bulk when possible, and choose items packaged in cardboard, glass, or metal instead of plastic. Many stores now offer refill stations for products like detergent, shampoo, and cooking oil.</p>
                    
                    <h3>3. Avoid Single-Use Plastics</h3>
                    <p>Single-use plastics like straws, utensils, and water bottles are major contributors to plastic pollution. Carry a reusable water bottle, keep a set of utensils at your desk or in your bag, and politely decline straws when ordering drinks.</p>
                    
                    <h3>4. Properly Recycle What You Can't Avoid</h3>
                    <p>While reducing plastic use is the goal, sometimes plastic is unavoidable. When this happens, make sure to recycle properly. Check your local recycling guidelines to understand what can and cannot be recycled in your area.</p>
                    
                    <h3>5. Support Businesses with Sustainable Practices</h3>
                    <p>Vote with your wallet by supporting companies that prioritize sustainability. Look for businesses that use minimal packaging, offer refill programs, or use recycled materials in their products.</p>
                    
                    <p>By implementing these simple strategies, you can significantly reduce your plastic waste and contribute to a healthier planet for future generations.</p>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-read" id="readBtn">I Have Read It</button>
                    <span class="points-feedback" id="pointsFeedback">+50 points for reading!</span>
                    <button class="btn btn-quiz" id="quizBtn">Take Quiz</button>
                </div>

                <div class="quiz-container" id="quizContainer">
                    <h2 class="quiz-title">Test Your Knowledge</h2>
                    
                    <div class="quiz-question">
                        <div class="question-text">1. What is one of the easiest ways to reduce plastic waste according to the article?</div>
                        <div class="options-container">
                            <label class="option">
                                <input type="radio" name="q1" value="a"> Buy more plastic products
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="b"> Use reusable bags and containers
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="c"> Always choose products with plastic packaging
                            </label>
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <div class="question-text">2. What should you do when plastic is unavoidable?</div>
                        <div class="options-container">
                            <label class="option">
                                <input type="radio" name="q2" value="a"> Throw it in the regular trash
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="b"> Recycle it properly according to local guidelines
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="c"> Burn it to reduce volume
                            </label>
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <div class="question-text">3. How can you support businesses with sustainable practices?</div>
                        <div class="options-container">
                            <label class="option">
                                <input type="radio" name="q3" value="a"> Only buy from companies that use excessive packaging
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="b"> Choose companies that use minimal packaging and offer refill programs
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="c"> Ignore their packaging practices
                            </label>
                        </div>
                    </div>
                    
                    <button class="btn btn-read" id="submitQuiz">Submit Answers</button>
                    
                    <div class="quiz-result" id="quizResult"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>SustainaLearn</h3>
                    <p>Making sustainability accessible, engaging, and actionable for everyone.</p>
                    <div class="social-links">
                        <a href="#" class="social-icon">f</a>
                        <a href="#" class="social-icon">in</a>
                        <a href="#" class="social-icon">ig</a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="home.html">Home</a></li>
                        <li><a href="home.html#events">Events</a></li>
                        <li><a href="game.html">Games</a></li>
                        <li><a href="home.html#news">News</a></li>
                        <li><a href="points.html">My Points</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul>
                        <li>123 Green Street, Eco City</li>
                        <li>+1 (123) 456-7890</li>
                        <li>socialandgreen@gmail.com</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 SustainaLearn. All rights reserved. | Designed with ðŸ’š for a greener planet</p>
            </div>
        </div>
    </footer>

    <script>
        // Toast notification function
        function showToast(message, type = 'info', duration = 3000) {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // Global variable for current user
        let currentUser = null;

        // Firebase Auth listener - ensures user is logged in
        auth.onAuthStateChanged(async (firebaseUser) => {
            const authButtons = document.getElementById('authButtons');
            
            if (!firebaseUser) {
                // Not logged in
                localStorage.removeItem('sustainalearn_currentUser');
                authButtons.innerHTML = `
                    <button class="btn btn-login" id="loginBtn">Login</button>
                    <button class="btn btn-register" id="registerBtn">Register</button>
                `;
                
                document.getElementById('loginBtn').addEventListener('click', function() {
                    window.location.href = 'login.html';
                });
                
                document.getElementById('registerBtn').addEventListener('click', function() {
                    window.location.href = 'register.html';
                });
                
                showToast('Please log in to read articles and earn points', 'info', 2000);
                setTimeout(() => window.location.href = 'login.html', 2000);
                return;
            }
            
            try {
                // Get user data from Firestore
                const userRef = db.collection('users').doc(firebaseUser.uid);
                const userSnap = await userRef.get();
                
                if (userSnap.exists) {
                    const userData = userSnap.data();
                    currentUser = {
                        uid: firebaseUser.uid,
                        email: userData.email,
                        username: userData.username || userData.email,
                        firstName: userData.firstName || userData.name || 'User',
                        lastName: userData.lastName || '',
                        ...userData
                    };
                    
                    // Update localStorage for compatibility
                    localStorage.setItem('sustainalearn_currentUser', JSON.stringify(currentUser));
                    
                    // Update auth buttons - User is logged in
                    authButtons.innerHTML = `
                        <span style="margin-right: 15px; color: var(--primary-green);">Welcome, ${currentUser.firstName}</span>
                        <a href="points.html" class="btn btn-login">My Points</a>
                        <button class="btn btn-register" id="logoutBtn">Logout</button>
                    `;
                    
                    document.getElementById('logoutBtn').addEventListener('click', async function() {
                        try {
                            await auth.signOut();
                            localStorage.removeItem('sustainalearn_currentUser');
                            window.location.href = 'index.html';
                        } catch (error) {
                            console.error('Logout error:', error);
                        }
                    });
                    
                    // Initialize article functionality
                    initializeArticle();
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Error loading your profile. Please try again.', 'error', 4000);
            }
        });

        // Article reading and quiz functionality
        async function initializeArticle() {
            const readBtn = document.getElementById('readBtn');
            const quizBtn = document.getElementById('quizBtn');
            const quizContainer = document.getElementById('quizContainer');
            const submitQuiz = document.getElementById('submitQuiz');
            const quizResult = document.getElementById('quizResult');
            
            const articleId = 'article1';
            
            // Check if user has already read this article from currentUser data
            if (currentUser.articlesRead && currentUser.articlesRead.includes(articleId)) {
                readBtn.textContent = 'Already Read âœ“';
                readBtn.disabled = true;
                document.getElementById('pointsFeedback').classList.add('show');
            }
            
            if (currentUser.articlesQuizPassed && currentUser.articlesQuizPassed.includes(articleId)) {
                quizBtn.textContent = 'Quiz Completed';
                quizBtn.disabled = true;
                quizBtn.style.backgroundColor = '#6c757d';
            }
            
            // Mark article as read
            readBtn.addEventListener('click', async function() {
                if (!currentUser || !currentUser.uid) return;
                
                // Check if already read
                if (currentUser.articlesRead && currentUser.articlesRead.includes(articleId)) {
                    showToast('You have already read this article', 'info');
                    return;
                }
                
                try {
                    // Update Firestore
                    const userRef = db.collection('users').doc(currentUser.uid);
                    await userRef.update({
                        articlesRead: firebase.firestore.FieldValue.arrayUnion(articleId),
                        points: firebase.firestore.FieldValue.increment(50)
                    });
                    
                    // Update currentUser object
                    if (!currentUser.articlesRead) currentUser.articlesRead = [];
                    currentUser.articlesRead.push(articleId);
                    currentUser.points = (currentUser.points || 0) + 50;
                    
                    // Update localStorage
                    localStorage.setItem('sustainalearn_currentUser', JSON.stringify(currentUser));
                    
                    // Update button
                    readBtn.textContent = 'Already Read âœ“';
                    readBtn.disabled = true;
                    
                    // Show points feedback
                    const pointsFeedback = document.getElementById('pointsFeedback');
                    pointsFeedback.classList.add('show');
                    
                    showToast('Thank you for reading! You earned 50 points.', 'success', 4000);
                } catch (error) {
                    console.error('Error marking article as read:', error);
                    showToast('Error saving your progress. Please try again.', 'error');
                }
            });
            
            // Show quiz
            quizBtn.addEventListener('click', function() {
                quizContainer.style.display = 'block';
            });
            
            // Submit quiz
            submitQuiz.addEventListener('click', async function() {
                // Get answers
                const q1 = document.querySelector('input[name="q1"]:checked');
                const q2 = document.querySelector('input[name="q2"]:checked');
                const q3 = document.querySelector('input[name="q3"]:checked');
                
                // Check if all questions are answered
                if (!q1 || !q2 || !q3) {
                    showToast('Please answer all questions', 'info');
                    return;
                }
                
                // Check answers (correct answers: b, b, b)
                let correctCount = 0;
                if (q1.value === 'b') correctCount++;
                if (q2.value === 'b') correctCount++;
                if (q3.value === 'b') correctCount++;
                
                // Show result
                if (correctCount === 3) {
                    quizResult.textContent = 'Perfect! You got all answers correct!';
                    quizResult.className = 'quiz-result quiz-success';
                    quizResult.style.display = 'block';
                    
                    // Check if user has already passed this quiz
                    if (!currentUser.articlesQuizPassed) currentUser.articlesQuizPassed = [];
                    
                    if (!currentUser.articlesQuizPassed.includes(articleId)) {
                        try {
                            // Update Firestore
                            const userRef = db.collection('users').doc(currentUser.uid);
                            await userRef.update({
                                articlesQuizPassed: firebase.firestore.FieldValue.arrayUnion(articleId),
                                points: firebase.firestore.FieldValue.increment(100)
                            });
                            
                            // Update currentUser object
                            currentUser.articlesQuizPassed.push(articleId);
                            currentUser.points = (currentUser.points || 0) + 100;
                            
                            // Update localStorage
                            localStorage.setItem('sustainalearn_currentUser', JSON.stringify(currentUser));
                            
                            // Update button
                            quizBtn.textContent = 'Quiz Completed';
                            quizBtn.disabled = true;
                            quizBtn.style.backgroundColor = '#6c757d';
                            
                            quizResult.innerHTML += '<div class="points-earned">You earned 100 bonus points!</div>';
                        } catch (error) {
                            console.error('Error saving quiz result:', error);
                            showToast('Error saving your quiz result. Please try again.', 'error');
                        }
                    } else {
                        quizResult.innerHTML += '<div>You have already earned points for this quiz.</div>';
                    }
                } else {
                    quizResult.textContent = `You got ${correctCount} out of 3 correct. Try again!`;
                    quizResult.className = 'quiz-result quiz-error';
                    quizResult.style.display = 'block';
                }
            });
        } // End initializeArticle
    </script>
</body>
</html>